# Hello Siling Classify and Extract éƒ¨ç½²æŒ‡å—

## ğŸ“‹ éƒ¨ç½²æ–¹å¼

æœ¬é¡¹ç›®ä½¿ç”¨ç®€å•çš„æœåŠ¡å™¨éƒ¨ç½²æ–¹å¼ï¼š
- **ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²** - ä½¿ç”¨ systemd å’Œ nginx

## ğŸ–¥ï¸ ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²

### 1. æœåŠ¡å™¨åˆå§‹åŒ–

åœ¨æœåŠ¡å™¨ `47.98.154.221` ä¸Šè¿è¡Œåˆå§‹åŒ–è„šæœ¬ï¼š

```bash
# ç™»å½•æœåŠ¡å™¨
ssh developer@47.98.154.221

# è¿è¡Œåˆå§‹åŒ–è„šæœ¬
chmod +x deploy/setup_server.sh
./deploy/setup_server.sh
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶å¹¶ç¼–è¾‘ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼š

```bash
cp ~/deploy/.env.template ~/deploy/.env
nano ~/deploy/.env
```

æ›´æ–°ä»¥ä¸‹é…ç½®ï¼š
- `DATABASE_URL` - PostgreSQL è¿æ¥å­—ç¬¦ä¸²
- `GEMINI_API_KEY` - Google Gemini API å¯†é’¥
- å…¶ä»–æœåŠ¡é…ç½®

### 3. GitLab CI/CD é…ç½®

åœ¨ GitLab é¡¹ç›®ä¸­è®¾ç½®ä»¥ä¸‹ CI/CD å˜é‡ï¼š

#### å¿…éœ€å˜é‡
- `SSH_PRIVATE_KEY` - æœåŠ¡å™¨ SSH ç§é’¥
- `DATABASE_URL` - æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
- `GEMINI_API_KEY` - Gemini API å¯†é’¥

#### å¯é€‰å˜é‡
- `MINIO_ENDPOINT` - MinIO æœåŠ¡åœ°å€
- `MINIO_ACCESS_KEY` - MinIO è®¿é—®å¯†é’¥
- `MINIO_SECRET_KEY` - MinIO ç§˜å¯†å¯†é’¥
- `KAFKA_BOOTSTRAP_SERVERS` - Kafka æœåŠ¡åœ°å€

### 4. éƒ¨ç½²æµç¨‹

1. **æ¨é€ä»£ç åˆ° main åˆ†æ”¯**
2. **åœ¨ GitLab CI/CD é¡µé¢æ‰‹åŠ¨è§¦å‘éƒ¨ç½²**ï¼š
   - `deploy_backend` - éƒ¨ç½²åç«¯æœåŠ¡
   - `deploy_frontend` - éƒ¨ç½²å‰ç«¯è°ƒè¯•ç•Œé¢
   - `rollback_backend` - å›æ»šåç«¯
   - `rollback_frontend` - å›æ»šå‰ç«¯

### 5. æœåŠ¡ç®¡ç†

```bash
# æŸ¥çœ‹åç«¯æœåŠ¡çŠ¶æ€
sudo systemctl status hello-siling-backend

# é‡å¯åç«¯æœåŠ¡
sudo systemctl restart hello-siling-backend

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u hello-siling-backend -f

# æŸ¥çœ‹ Nginx çŠ¶æ€
sudo systemctl status nginx
```



## ğŸ”§ éƒ¨ç½²æ¶æ„

### æœåŠ¡å™¨éƒ¨ç½²æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Nginx       â”‚    â”‚   Backend       â”‚
â”‚   (Port 80)     â”‚â—„â”€â”€â–ºâ”‚  (Port 8000)    â”‚
â”‚  Frontend +     â”‚    â”‚  FastAPI        â”‚
â”‚  API Proxy      â”‚    â”‚  Python 3.11    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚
         â”‚                       â”‚
         â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Static Files   â”‚    â”‚  PostgreSQL     â”‚
â”‚ /var/www/html/  â”‚    â”‚  MinIO          â”‚
â”‚ hello-siling-   â”‚    â”‚  Kafka/Redpanda â”‚
â”‚ classify-and-   â”‚    â”‚                 â”‚
â”‚ extract/        â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ éƒ¨ç½²ç‰¹æ€§

### ç‹¬ç«‹éƒ¨ç½²
- **åç«¯ç‹¬ç«‹éƒ¨ç½²** - API æœåŠ¡ï¼Œä¾›å…¶ä»–æœåŠ¡è°ƒç”¨
- **å‰ç«¯ç‹¬ç«‹éƒ¨ç½²** - è°ƒè¯•ç•Œé¢ï¼Œç‹¬ç«‹äºåç«¯

### é«˜å¯ç”¨æ€§
- **è‡ªåŠ¨é‡å¯** - systemd è‡ªåŠ¨é‡å¯å¤±è´¥çš„æœåŠ¡
- **å¥åº·æ£€æŸ¥** - å®šæœŸæ£€æŸ¥æœåŠ¡çŠ¶æ€
- **æœåŠ¡ç›‘æ§** - é€šè¿‡ systemd ç›‘æ§æœåŠ¡çŠ¶æ€

### å›æ»šæ”¯æŒ
- **è‡ªåŠ¨å¤‡ä»½** - æ¯æ¬¡éƒ¨ç½²å‰è‡ªåŠ¨å¤‡ä»½
- **ä¸€é”®å›æ»š** - æ”¯æŒå¿«é€Ÿå›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬
- **ç‹¬ç«‹å›æ»š** - å‰ç«¯å’Œåç«¯å¯ç‹¬ç«‹å›æ»š

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æœåŠ¡å™¨éƒ¨ç½²
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status hello-siling-classify-and-extract-backend

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
sudo journalctl -u hello-siling-classify-and-extract-backend -f

# æŸ¥çœ‹ Nginx è®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/access.log
```

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

1. **SSH å¯†é’¥ç®¡ç†** - ä½¿ç”¨ä¸“ç”¨éƒ¨ç½²å¯†é’¥
2. **ç¯å¢ƒå˜é‡** - æ•æ„Ÿä¿¡æ¯ä½¿ç”¨ GitLab CI/CD å˜é‡
3. **ç½‘ç»œè®¿é—®** - é™åˆ¶ä¸å¿…è¦çš„ç«¯å£è®¿é—®
4. **å®šæœŸæ›´æ–°** - ä¿æŒç³»ç»Ÿå’Œä¾èµ–æ›´æ–°

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æœåŠ¡å¯åŠ¨å¤±è´¥**
   ```bash
   # æ£€æŸ¥æ—¥å¿—
   sudo journalctl -u hello-siling-backend -n 50
   
   # æ£€æŸ¥ç«¯å£å ç”¨
   sudo netstat -tlnp | grep :8000
   ```

2. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   ```bash
   # æ£€æŸ¥ PostgreSQL çŠ¶æ€
   sudo systemctl status postgresql
   
   # æµ‹è¯•è¿æ¥
   psql -h localhost -U legal_user -d legal_docs_dev
   ```

3. **å‰ç«¯æ— æ³•è®¿é—®**
   ```bash
   # æ£€æŸ¥ Nginx é…ç½®
   sudo nginx -t
   
   # æ£€æŸ¥æ–‡ä»¶æƒé™
   ls -la /var/www/html/hello-siling/
   ```

### è”ç³»æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æœåŠ¡æ—¥å¿—
2. ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
3. ç½‘ç»œè¿æ¥çŠ¶æ€
4. é…ç½®æ–‡ä»¶è¯­æ³•
